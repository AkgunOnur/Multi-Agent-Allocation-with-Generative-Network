input-dir input map_zero.txt
[32m2021-10-12 16:42:53.318[39m | [1mINFO[22m | [90m/home/avsp/Masa√ºst√º/ganner/environment/level_utils.py:75[39m | Tokens in level ['-', 'W', 'X']
Library size increased: 1
input-dir input map_zero.txt
[32m2021-10-12 16:42:53.323[39m | [1mINFO[22m | [90m/home/avsp/Masa√ºst√º/ganner/environment/level_utils.py:75[39m | Tokens in level ['-', 'W', 'X']
Library size increased: 1
MODE: train
(1, 1, 3, 20, 20)
  0%|                                                                                              | 0/15 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "main.py", line 199, in <module>
    main()
  File "main.py", line 94, in main
    generated_map = g.train(env, sample_map, classifier, opt)
  File "/home/avsp/Masa√ºst√º/ganner/train.py", line 136, in train
    errG.backward(retain_graph=False)
  File "/home/avsp/.local/lib/python3.6/site-packages/torch/tensor.py", line 198, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/avsp/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 100, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: Function AddBackward0 returned an invalid gradient at index 1 - expected type TensorOptions(dtype=double, device=cpu, layout=Strided, requires_grad=false) but got TensorOptions(dtype=double, device=cuda:0, layout=Strided, requires_grad=false) (validate_outputs at /pytorch/torch/csrc/autograd/engine.cpp:484)
frame #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x46 (0x7fd57cf5d536 in /home/avsp/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x2d84224 (0x7fd510ccc224 in /home/avsp/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #2: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&) + 0x548 (0x7fd510ccdd58 in /home/avsp/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #3: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&, bool) + 0x3d2 (0x7fd510ccfce2 in /home/avsp/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #4: torch::autograd::Engine::thread_init(int) + 0x39 (0x7fd510cc8359 in /home/avsp/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #5: torch::autograd::python::PythonEngine::thread_init(int) + 0x38 (0x7fd51d1f34d8 in /home/avsp/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #6: <unknown function> + 0xc9039 (0x7fd5c04b6039 in /home/avsp/anaconda3/envs/gpn/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x76db (0x7fd5ea4166db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #8: clone + 0x3f (0x7fd5ea13f71f in /lib/x86_64-linux-gnu/libc.so.6)